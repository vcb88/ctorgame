# Упрощение метаданных игры

## Изменения в метаданных

1. Упрощена структура GameMeta:
   - Удалены избыточные поля
   - Унифицированы временные метки (Unix timestamp)
   - Упрощено представление игроков

До:
```typescript
export interface GameMetadata {
    gameId: string;
    code: string;
    status: GameStatus;
    startTime: string;
    endTime?: string;
    lastActivityAt: string;
    expiresAt: string;
    players: {
        first?: string;
        second?: string;
    };
    boardSize: ISize;
    totalTurns: number;
    duration?: number;
    winner?: PlayerNumber;
    finalScore?: {
        player1: number;
        player2: number;
    };
}
```

После:
```typescript
export type GameMeta = {
    id: string;
    code: string;
    status: GameStatus;
    players: [string?, string?];
    created: number;
    updated: number;
    expires: number;
    finished?: number;
};
```

2. Упрощена структура статистики:
   - Выделена отдельная статистика
   - Оптимизирована история ходов
   - Добавлены утилитарные функции

До:
```typescript
export interface GameDetails {
    moves: IGameMove[];
    timing: {
        moveTimes: number[];
        avgMoveTime: number;
    };
    territoryHistory: Array<{
        player1: number;
        player2: number;
    }>;
}
```

После:
```typescript
export type GameStats = {
    moves: number;
    duration: number;
    winner?: PlayerNumber;
    scores?: Scores;
};
```

3. Упрощена история игры:
   - Объединены метаданные и история
   - Упрощена структура записи хода
   - Добавлены вспомогательные функции для расчётов

## Преимущества изменений

1. Упрощение кода:
   - Меньше вложенных структур
   - Более плоская иерархия данных
   - Меньше дублирования информации

2. Улучшение производительности:
   - Компактное хранение данных
   - Эффективная сериализация
   - Оптимизированные временные метки

3. Улучшение разработки:
   - Проще поддерживать код
   - Понятнее структура данных
   - Легче отлаживать

## Константы и конфигурация

1. Добавлены игровые константы:
   - Размер доски
   - Временные лимиты
   - Ограничения хранения
   - Сетевые таймауты
   - Очки за действия

2. Централизация конфигурации:
   - Все константы в одном месте
   - Документированные значения
   - Легкое изменение параметров

## Изменения в API

1. Новые утилитарные функции:
   - createGameMeta()
   - calculateGameDuration()
   - calculateGameStats()

2. Упрощенные интерфейсы:
   - Более понятные типы данных
   - Меньше проверок
   - Улучшенная типобезопасность

## Технический долг

1. Требуются изменения:
   - Обновить код, использующий старые метаданные
   - Мигрировать существующие данные
   - Обновить тесты

2. Возможные проблемы:
   - Совместимость со старыми форматами
   - Миграция исторических данных
   - Обновление внешних интеграций

## Следующие шаги

1. Обновить код, использующий метаданные:
   - Серверные обработчики
   - Клиентские компоненты
   - Хранилище данных

2. Обновить тесты:
   - Создать новые тест-кейсы
   - Обновить существующие тесты
   - Добавить проверки новых функций

3. Обновить документацию:
   - API документация
   - Примеры использования
   - Миграционное руководство